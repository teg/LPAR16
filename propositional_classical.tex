\chapter{Propositional Classical Logic}

%---------------------------------------
\begin{definition}\label{definition:PropositionalFormulae}
We define (\emph{propositional}) \emph{formulae} to be formulae built from the units $\ttt$ (true) and $\fff$ (false), and the binary logical relations \emph{disjunction} and \emph{conjunction}, $\vls[\alpha.\beta]$ and $\vls(\alpha.\beta)$.
\end{definition}

%---------------------------------------
\begin{remark}\label{remark:DeMorganNegation}
Negation is only defined for atoms, which is not a limitation thanks to De Morgan laws.
\end{remark}

\newcommand{\ai   }{\mathsf{ai}}
\newcommand{\aw   }{\mathsf{aw}}
\newcommand{\ac   }{\mathsf{ac}}
\newcommand{\aid  }{\ai{\downarrow}}
\newcommand{\awd  }{\aw{\downarrow}}
\newcommand{\acd  }{\ac{\downarrow}}
\newcommand{\aiu  }{\ai{\uparrow}}
\newcommand{\awu  }{\aw{\uparrow}}
\newcommand{\acu  }{\ac{\uparrow}}
\newcommand{\swi  }{\mathsf{s}}
\newcommand{\med  }{\mathsf{m}}
\newcommand{\asor }{=_{\vee\mathsf{a}}}
\newcommand{\asand}{=_{\wedge\mathsf{a}}}
\newcommand{\coor }{=_{\vee\mathsf{c}}}
\newcommand{\coand}{=_{\wedge\mathsf{c}}}
\newcommand{\unor }{=_{\vee\mathsf{u}}}
\newcommand{\unand}{=_{\wedge\mathsf{u}}}
\newcommand{\idor }{=_{\vee\mathsf{i}}}
\newcommand{\idand}{=_{\wedge\mathsf{i}}}

\newcommand{\SKS}{\mathsf{SKS}}

\begin{definition}\label{definition:SKS}
System $\SKS$ is defined by the following \emph{structural} inference rules:
\[
\vlinf{\aid}{}{\vls[a.\bar a]}{\ttt}\qquad
\vlinf{\awd}{}{a}{\fff}\qquad
\vlinf{\acd}{}{a}{\vls[a.a]}
\]
\[
\vlinf{\aiu}{}{\fff}{\vls[a.\bar a]}\qquad
\vlinf{\awu}{}{\ttt}{a}\qquad
\vlinf{\acu}{}{\vls(a.a)}{a}\quad,
\]
the two \emph{logical} inference rules
\[
\vlinf{\swi}{}{\vls[(A.B).C]}{\vls(A.[B.C])}\qquad
\vlinf{\med}{}{\vls([A.D].[B.C])}{\vls[(A.B).(C.D)]}
\]
and, for each $\rho\in\{\coor,\coand,\asor,\asand,\unor,\unand,\idor,\idand\}$, the \emph{invertible} rule $\vlinf{\rho}{}{\beta}{\alpha}$, such that $\alpha$ and $\beta$ are opposite sides of
\vlstore{
\vls[A.B]       &\coor\vls[B.A]      \quad,&
\vls[A.\fff]    &\unor\vls[A]        \quad,\\
\vls(A.B)       &\coand\vls(B.A)     \quad,&
\vls(A.\ttt)    &\unand\vls(A)       \quad,\\
\vls[[A.B].C]   &\asor\vls[A.[B.C]]  \quad,&
\vls[\ttt.\ttt] &\idor\vls[\ttt]     \quad,\\
\vls((A.B).C)   &\asand\vls(A.(B.C)) \quad,&
\vls(\fff.\fff) &\idand\vls(\fff)    \quad,}
\begin{align*}
\vlread
\end{align*}
respectively.
\end{definition}

\TODO{Change into a completeness proof of SKS.}

\begin{theorem}\label{theorem:SKSComplete}
A deep inference system $\mathcal{S}$ is complete for propositional classical logic if
\begin{enumerate}
 \item Given a formula $\alpha$ and an atom $a$, there exists a derivation 
  \[
   \vlder{}{\mathcal{S}}
   {
    \alpha
   }
   {
    \vls(\alpha\{a/\ttt,\bar a/\fff\}.\alpha\{a/\fff,\bar a/\ttt\})
   }\quad
  \]
 and
 \item Given a formula $\alpha$ that is logically equivalent to $\ttt$ and that does not contain any atoms, there exists a derivation
  \[
   \vlder{}{\mathcal{S}}
   {
    \alpha
   }
   {
    \ttt
   }\quad.
  \]
\end{enumerate}
\end{theorem}

\begin{proof}[Sketch of Proof]
Let $\alpha$ be a tautology. Apply (1) repeatedly to obtain a conjunction of formulae not containing atoms. Each of the conjuncts is a truth value assignment to $\alpha$, so the conjunction is logically equivalent to $\ttt$. Apply (2) to obtain the proof.
\end{proof}


\TODO{Check and prove (Complexity paper by Alessio and Paola).}

\begin{lemma}\label{lemma:EquationsSize}
If there exists a derivation $\vlder{}{\{\coor,\coand,\asor,\asand,\unor,\unand,\idor,\idand\}}{\beta}{\alpha}$, then there exists a derivation $\vlder{\Phi}{\{\coor,\coand,\asor,\asand,\unor,\unand,\idor,\idand\}}{\beta}{\alpha}$, such that $|\Phi|\le(|\alpha|+|\beta|)^2$.
\end{lemma}

%TODO: reread

\begin{remark}\label{remark:EquationsShorthand}
When $\vlder{}{\{\coor,\coand,\asor,\asand,\unor,\unand,\idor,\idand\}}{\beta}{\alpha}$, we say that $\alpha=\beta$ and we often write $\vlinf{=}{}{\beta}{\alpha}$ instead of the derivation. Using this shorthand only compresses derivations by a polynomial, so it does not affect any complexity results.
\end{remark}

\begin{remark}\label{remark:ImplicitEquations}
When we work in (subsystems of) $\SKS$, we often omit mentioning the invertible rules $\coor$, $\coand$, $\asor$, $\asand$, $\unor$, $\unand$, $\idor$ and $\idand$. \emph{E.g.}, when we refer to the system $\{\swi\}$ we mean the system $\{\swi,\coor,\coand,\asor,\asand,\unor,\unand,\idor,\idand\}$, and we write
\[
\vlinf{\swi}{}{\vls[\alpha.(\beta.\gamma)]}{\vls([\alpha.\beta].\gamma)}\quad,
\]
instead of
\[
\vlderivation
{
 \vlin{=}{}
 {
  \vls[\alpha.(\beta.\gamma)]
 }
 {
  \vlin{\swi}{}
  {
   \vls[(\gamma.\beta).\alpha]
  }
  {
   \vlin{=}{}
   {
    \vls(\gamma.[\beta.\alpha])
   }
   {
    \vlhy
    {
     \vls([\alpha.\beta].\gamma)
    }
   }
  }
 }
}\quad.
\]
See the proofs of Theorems~\vrefrange{theorem:PathBreakerSound}{theorem:MultipleIsolatedSubflowsRemovalMaybeSound} for more examples of implicit equations.
\end{remark}

\begin{lemma}\label{lemma:SuperSwitch}
Given a context $\xi\vlhole$ and a formula $\alpha$ there exist derivations $\vlder{}{\{\swi\}}{\xi\{\alpha\}}{\vls(\alpha.\xi\{\ttt\})}$ and $\vlder{}{\{\swi\}}{\vls[\xi\{\fff\}.\alpha]}{\xi\{\alpha\}}$.
\end{lemma}

\begin{proof}
We show how to construct the first derivation, the second one can be done symmetrically. We argue by induction on the number of atoms in $\xi\vlhole$. The base case, $\xi\vlhole=\vlhole$, is trivial and the inductive cases are:

\[
\vlderivation
{
 \vlin{=}{}{\xi\{\alpha\}}
 {
  \vlin{\swi}{}{\vlsbr[\vlder{\Psi}{\{\swi\}}{\xi'\{\alpha\}}{\vls(\alpha.\xi'\{\ttt\})}\;\;.\;\;\beta]}
  {
   \vlin{=}{}{\vls(\alpha.[\xi'\{\ttt\}.\beta])}
   {
    \vlhy{\vls(\alpha.\xi\{\ttt\})}
   }
  }
 }
}\qquad\mbox{and}\qquad
\vlderivation
{
 \vlin{=}{}{\xi\{\alpha\}}
 {
  \vlin{=}{}{\vlsbr(\vlder{\Psi'}{\{\swi\}}{\xi'\{\alpha\}}{\vls(\alpha.\xi'\{\ttt\})}\;\;.\;\;\beta)}
  {
   \vlhy{\vls(\alpha.\xi\{\ttt\})}
  }
 }
}\quad,
\]
for some $\xi'\vlhole$ and $\beta$ where $\beta$ is not a unit and $\Psi$ and $\Psi'$ exist by the inductive hypothesis.
\end{proof}

\newcommand{\supers}{\mathsf{ss}}
\newcommand{\ssu}{\supers\uparrow}
\newcommand{\ssd}{\supers\downarrow}

\begin{remark}\label{remark:SuperSwitch}
We often write $\vlinf{\ssu}{}{\xi\{\alpha\}}{\vls(\alpha.\xi\{\ttt\})}$ and $\vlinf{\ssd}{}{\vls[\xi\{\ttt\}.\alpha]}{\xi\{\alpha\}}$, instead of, respectively, the derivations $\vlder{}{\{\swi\}}{\xi\{\alpha\}}{\vls(\alpha.\xi\{\ttt\})}$ and $\vlder{}{\{\swi\}}{\vls[\xi\{\fff\}.\alpha]}{\xi\{\alpha\}}$, as defined in the proof of Lemma~\vref{lemma:SuperSwitch}. Instead of the derivation
\[
\vlinf{\swi}{}
{
 \vls[\zeta\{\fff\}\;.\;\vlinf{\ssu}{}{\xi\{\alpha\}}{\vls(\alpha.\xi\{\ttt\})}]
}
{
 \vls(\vlinf{\ssd}{}{\vls[\zeta\{\fff\}.\alpha]}{\zeta\{\alpha\}}\;.\;\xi\{\ttt\})
}
\]
we write $\vlinf{\supers}{}{\vls[\zeta\{\fff\}.\xi\{\alpha\}]}{\vls(\zeta\{\alpha\}.\xi\{\ttt\})}$.
\end{remark}

\begin{lemma}\label{lemma:GenericContraction}
Given a formula $\alpha$ and a positive integer $n$, there exist derivations $\vlupsmash{\vlder{}{\{\acd,\med\}}{\alpha}{\bigvee_{i=1}^{n}\alpha}}$ and $\vlupsmash{\vlder{}{\{\acu,\med\}}{\bigwedge_{i=1}^{n}\alpha}{\alpha}}$.
\end{lemma}

\begin{proof}
We show how to construct the first derivation, the second one can be done symmetrically. We argue by induction on $n$. The first base case, $n=1$, is trivial and for the second base case, $n=2$, we argue by induction on the number of atom occurrences in $\alpha$. We have to consider the following base case and two inductive cases:
\[
\vlinf{\acd}{}{a}{\vls[a.a]}
\qquad\hbox{,}\qquad
\vlderivation
{
 \vlin{=}{}{\vls(\alpha.\beta)}
 {
  \vlin{\med}{}{\vlsbr(\vlder{}{\{\acd,\med\}}{\alpha}{\vls[\alpha.\alpha]}\;\;.\;\;\vlder{}{\{\acd,\med\}}{\beta}{\vls[\beta.\beta]})}
  {
   \vlhy{\vls[(\alpha.\beta).(\alpha.\beta)]}
  }
 }
}\qquad\hbox{and}\qquad
\vlderivation
{
 \vlin{=}{}{\vls[\alpha.\beta]}
 {
  \vlin{=}{}{\vlsbr[\vlder{}{\{\acd,\med\}}{\alpha}{\vls[\alpha.\alpha]}\;\;.\;\;\vlder{}{\{\acd,\med\}}{\beta}{\vls[\beta.\beta]}]}
  {
   \vlhy{\vls[[\alpha.\beta].[\alpha.\beta]]}
  }
 }
}\quad.
\]
Finally, we show the inductive case, $n>2$:
\[
\vlderivation
{
 \vlde{}{\{\acd,\med\}}{\alpha}
 {
  \vlin{=}{}{\vlsbr[\vlder{}{\{\acd,\med\}}{\alpha}{\bigvee_{i=1}^{n-\lfloor n/2\rfloor}\alpha}\;\;.\;\;\vlder{}{\{\acd,\med\}}{\alpha}{\bigvee_{i=1}^{\lfloor n/2\rfloor}\alpha}]}
  {
   \vlhy{\bigvee_{i=1}^{n}\alpha}
  }
 }
}\quad.
\]
\end{proof}

\newcommand{\contr}{\mathsf{c}}
\newcommand{\cod}{{\contr{\downarrow}}}
\newcommand{\cou}{{\contr{\uparrow}}}

\TODO{Define $\star$ notation}

\begin{remark}\label{remark:GenericContraction}
In the non-atomic version of system $\SKS$ the derivations shown in Lemma~\vref{lemma:GenericContraction} correspond to repeated applications of (co)contractions. For this reason we sometimes write the inference rules $\vlinf{n\cdot\cod}{}{\alpha}{\bigvee_{i=1}^{n}\alpha}$ and $\vlinf{n\cdot\cou}{}{\bigwedge_{i=1}^{n}\alpha}{\alpha}$ instead of the derivations $\vlder{}{\{\acd,\med\}}{\alpha}{\bigvee_{i=1}^{n}\alpha}$ and $\vlupsmash{\vlder{}{\{\acu,\med\}}{\bigwedge_{i=1}^{n}\alpha}{\alpha}}$, respectively.
\end{remark}