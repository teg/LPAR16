\chapter{Definitions}

%---------------------------------------
\begin{definition}\label{definition:FlowLabels}
We call the following six diagrams (\emph{atomic-flow}) \emph{labels}\index{flow!labels}:
\[
\begin{array}{@{}c@{}c@{}c@{}}
      \vcenter{\afaid{}{}{}{}{}{}}&
\qquad\vcenter{\afawd{}{}{}{}}&
\qquad\vcenter{\afacd{}{}{}{}{}{}}\\
\noalign{\smallskip}
      \mbox{$\aid$ or \emph{interaction}}&
\qquad\mbox{$\awd$ or \emph{weakening}}&
\qquad\mbox{$\acd$ or \emph{contraction}}\\
\noalign{\bigskip}
      \vcenter{\afaiu{}{}{}{}{}{}}&
\qquad\vcenter{\afawu{}{}{}{}}&
\qquad\vcenter{\afacu{}{}{}{}{}{}}\\
\noalign{\smallskip}
      \mbox{$\aiu$ or \emph{cut}}&
\qquad\mbox{$\awu$ or \emph{coweakening}}&
\qquad\mbox{$\acu$ or \emph{cocontraction}}\\
\end{array}\quad.
\]
\end{definition}

\TODO{Make sure the symbols we use later are all defined here. In particular we need $\iota$ to denote edges, maybe also more.}

\newcommand{\ppl  }{{\mathchoice{\scriptstyle+}
                                {\scriptstyle+}
                                {\scriptstyle+}
                                {\scriptscriptstyle+}}}
\newcommand{\pmi  }{{\mathchoice{\scriptstyle-}
                                {\scriptstyle-}
                                {\scriptstyle-}
                                {\scriptscriptstyle-}}}
\newcommand{\card}[1]{\mathord\vert #1\mathord\vert}
\newcommand{\up}{{\mathit up}}
\newcommand{\lo}{{\mathit lo}}
%---------------------------------------
\begin{definition}\label{definition:AtomicFlow}
An (\emph{atomic}) \emph{flow}\index{flow}\index{atomic flow|see{flow}} is a tuple $(V,E,\eta,\up,\lo)$, denoted $\phi$ or $\psi$, such that:
\begin{enumerate}
%-------------------
\item $V$ is a finite set of \emph{vertices}\index{flow!vertices}, denoted by $\nu$;
%-------------------
\item $E$ is a finite set of \emph{edges}\index{flow!edges}, denoted by $\epsilon$ or $\iota$;
%-------------------
\item $\eta\colon V\to\{\aid,\aiu,\awd,\awu,\acd,\acu\}$ maps vertices to their \emph{labels}\index{flow!labels};
%-------------------
\item $\up\colon E\to V\cup\{\top\}$ and $\lo\colon E\to V\cup\{\bot\}$ are, respectively, the \emph{upper} and \emph{lower} maps, and $\top$ and $\bot$ are special vertices not belonging to $V$; we define, for every $\nu\in V\cup\{\top,\bot\}$, the set $L_\nu=\{\,\epsilon\mid\up(\epsilon)=\nu\,\}$ of \emph{lower edges of $\nu$}, the set $U_\nu=\{\,\epsilon\mid\lo(\epsilon)=\nu\,\}$ of \emph{upper edges of $\nu$}, and the set $E_\nu=L_\nu\cup U_\nu$ of \emph{edges of $\nu$};
%-------------------
\item if $\card S$ denotes the cardinality of set $S$, we have that
\begin{align*}
\mbox{if $\eta(\nu)=\aid$ then $\card{L_\nu}=2$ and $\card{U_\nu}=0$,}&\\
\mbox{if $\eta(\nu)=\aiu$ then $\card{L_\nu}=0$ and $\card{U_\nu}=2$,}&\\
\mbox{if $\eta(\nu)=\awd$ then $\card{L_\nu}=1$ and $\card{U_\nu}=0$,}&\\
\mbox{if $\eta(\nu)=\awu$ then $\card{L_\nu}=0$ and $\card{U_\nu}=1$,}&\\
\mbox{if $\eta(\nu)=\acd$ then $\card{L_\nu}=1$ and $\card{U_\nu}=2$,}&\\
\mbox{if $\eta(\nu)=\acu$ then $\card{L_\nu}=2$ and $\card{U_\nu}=1$;}&
\end{align*}
%-------------------
\item\label{ItAcycl} there is no sequence $\epsilon_1$, $\dots$, $\epsilon_h$ of edges of $V$ such that $\up(\epsilon_i)=\lo(\epsilon_{i+1\pmod h})$, for $1\le i\le h$;
%-------------------
\item\label{definition:AtomicFlow:item:PolarityAssignment} there is a \emph{polarity assignment}\index{flow!polarity assignment} $\pi\colon E\to\{\pmi,\ppl\}$ such that, for every $\nu\in V$,
\begin{enumerate}
%---------
\item if $\eta(\nu)\in\{\acd,\acu\}$ then $\pi(E_\nu)=\{\pmi\}$ or $\pi(E_\nu)=\{\ppl\}$;
%---------
\item if $\eta(\nu)\in\{\aid,\aiu\}$ then $\pi(E_\nu)=\{\pmi,\ppl\}$.
\end{enumerate}
\end{enumerate}
Given an atomic flow $\phi$, we say that the sets $L_\top=\{\epsilon_1,\dots,\epsilon_h\}$ and $U_\bot=\{\epsilon'_1,\dots,\epsilon'_k\}$ contain, respectively, the \emph{upper}\index{flow!upper edges} and \emph{lower edges of $\phi$}\index{flow!lower edges}.
\end{definition}

\TODO{Explain the use of colors and small numerals.}

\newcommand{\one  }{{\mathchoice{\scriptstyle\mathbf1}
                                {\scriptstyle\mathbf1}
                                {\scriptstyle\mathbf1}
                                {\scriptscriptstyle\mathbf1}}}
\newcommand{\two  }{{\mathchoice{\scriptstyle\mathbf2}
                                {\scriptstyle\mathbf2}
                                {\scriptstyle\mathbf2}
                                {\scriptscriptstyle\mathbf2}}}
\newcommand{\three}{{\mathchoice{\scriptstyle\mathbf3}
                                {\scriptstyle\mathbf3}
                                {\scriptstyle\mathbf3}
                                {\scriptscriptstyle\mathbf3}}}
\newcommand{\four }{{\mathchoice{\scriptstyle\mathbf4}
                                {\scriptstyle\mathbf4}
                                {\scriptstyle\mathbf4}
                                {\scriptscriptstyle\mathbf4}}}
\newcommand{\five }{{\mathchoice{\scriptstyle\mathbf5}
                                {\scriptstyle\mathbf5}
                                {\scriptstyle\mathbf5}
                                {\scriptscriptstyle\mathbf5}}}
\newcommand{\six  }{{\mathchoice{\scriptstyle\mathbf6}
                                {\scriptstyle\mathbf6}
                                {\scriptstyle\mathbf6}
                                {\scriptscriptstyle\mathbf6}}}
\newcommand{\seven}{{\mathchoice{\scriptstyle\mathbf7}
                                {\scriptstyle\mathbf7}
                                {\scriptstyle\mathbf7}
                                {\scriptscriptstyle\mathbf7}}}
\newcommand{\eight}{{\mathchoice{\scriptstyle\mathbf8}
                                {\scriptstyle\mathbf8}
                                {\scriptstyle\mathbf8}
                                {\scriptscriptstyle\mathbf8}}}
\newcommand{\nine }{{\mathchoice{\scriptstyle\mathbf9}
                                {\scriptstyle\mathbf9}
                                {\scriptstyle\mathbf9}
                                {\scriptscriptstyle\mathbf9}}}

\begin{definition}\label{definition:FlowIsomorphism}
An (\emph{atomic}) \emph{flow isomorphism}\index{flow!isomorphism} between the atomic flows $\phi_1=(V_1,E_1,\eta_1,\up_1,\lo_1)$ and $\phi_2=(V_2,E_2,\eta_2,\up_2,\lo_2)$ is a pair $(f_V,f_E)$, such that
\begin{itemize}
\item $f_V$ is a bijection from $V_1$ to $V_2$; and 
\item $f_E$ is a bijection from $E_1$ to $E_2$,
\end{itemize}
such that, for every $\epsilon$ in $E_1$,
\begin{itemize}
\item for every $\nu$ in $V_1$, $\up_1(\epsilon)=\nu$ (resp., $\lo_1(\epsilon)=\nu$) if and only if $\up_2(f_E(\epsilon))=f_V(\nu)$ (resp., $\lo_2(f_E(\epsilon))=f_V(\nu)$); and
\item $\up_1(\epsilon)=\top$ (resp., $\lo_1(\epsilon)=\bot$) if and only if $\up_2(f_E(\epsilon))=\top$ (resp., $\lo_2(f_E(\epsilon))=\bot$).
\end{itemize}
Given a polarity assignment $\pi$ to $\phi_1$, we define the polarity assignment $\pi$ to $\phi_2$, such that, for every $f_E(\epsilon)$ in $E_2$, $\pi(f_E(\epsilon))=\pi(\epsilon)$.
\end{definition}

\newbox\contrup\setbox\contrup=\hbox{$
   \divide\atflowunit by6\multiply\atflowunit by3\afsetunits
   \atomicflow{(0,0)*{\afacu{}{}{}{}{}{}}}$}
\newbox\contrdown\setbox\contrdown=\hbox{$
   \divide\atflowunit by6\multiply\atflowunit by3\afsetunits
   \atomicflow{(0,0)*{\afacd{}{}{}{}{}{}}}$}
\newbox\interdown\setbox\interdown=\hbox{$
   \divide\atflowunit by6\multiply\atflowunit by3\afsetunits
   \atomicflow{(0,0)*{\afaid{}{}{}{}{}{}}}$}
\newbox\interup\setbox\interup=\hbox{$
   \divide\atflowunit by6\multiply\atflowunit by3\afsetunits
   \atomicflow{(0,0)*{\afaiu{}{}{}{}{}{}}}$}
\newbox\weakdown\setbox\weakdown=\hbox{$
   \divide\atflowunit by6\multiply\atflowunit by3\afsetunits
   \atomicflow{(0,0)*{\afawd{}{}{}{}{}{}}}$}
\newbox\weakup\setbox\weakup=\hbox{$
   \divide\atflowunit by6\multiply\atflowunit by3\afsetunits
   \atomicflow{(0,0)*{\afawu{}{}{}{}{}{}}}$}

\begin{notation}\label{notation:LabelsOnBoxes}
Let $\phi$ be an atomic flow with upper edges $\boldsymbol\epsilon=\{\epsilon_1,\dots,\epsilon_n\}$ and lower edges $\boldsymbol\iota=\{\iota_1,\dots,\iota_m\}$, we then represent it as
\[
\atomicflow{
(-3, 6)*{\afvju4{\epsilon_1}{}};
( 0, 6)*{\cdots};
( 3, 6)*{\afvju4{}{\epsilon_n}};
( 0, 0)*{\affr88};
( 1, 2)*{\aflabelright\phi};
(-3,-6)*{\afvju4{\iota_1}{}};
( 0,-6)*{\cdots};
( 3,-6)*{\afvju4{}{\iota_m}};
}
\qquad\mbox{or}\qquad
\atomicflow{
( 0,6)*{\afvjum4{\boldsymbol\epsilon}{}};
( 0,0)*{\affr88};
( 1,2)*{\aflabelright\phi};
( 0,-6)*{\afvjdm4{\boldsymbol\iota}{}};
}\quad.
\]

We sometimes label an atomic flow by the image of its labeling function, $\eta(V)$, \emph{e.g.}
\[
\atomicflow{
( 0,8)*{\invisiblemark};
( 0,0)*{\affr88};
( 0,0)*{\copy\interdown};
( 0,-6)*{\afvjm4};
( 4,0)*{\invisiblemark}
}\quad,\quad
\atomicflow{
(-6,0)*{\invisiblemark};
( 0,6)*{\afvjm4};
( 0,0)*{\affr{12}8};
(-3,0)*{\copy\contrdown};
( 3,0)*{\copy\contrup};
( 0,-6)*{\afvjm4};
}\quad.
\]

In general, we represent atomic flows as directed-graph diagrams, except that the special vertices $\top$ and $\bot$ are not shown, and the labels of the vertices are explicitly shown as graphical elements. When we refer to the vertices of an atomic flow, we do not include $\top$ and $\bot$. Sometimes we identify vertices with their labels. 
\end{notation}

\begin{remark}
Given atomic flows $\phi_1=(V_1,E_1,\eta_1,\up_1,\lo_1)$ and $\phi_2=(V_2,E_2,\eta_2,\up_2,\lo_2)$, and a flow isomorphism $(f_V,f_E)$ between them, we observe that $f_V$ is a graph isomorphism between $(V_1,E_1)$ and $(V_2,E_2)$. We also note that we can not, in general, deduce $f_E$ from $f_V$. As an example, consider the flows
\[
\phi\;=\;
\atomicflow
{
(-3, 0)*{\invisiblemark};
( 0, 4)*{\afacu{\two}{}{}{\three}{\one}{}};
( 0,-4)*{\afacd{}{}{}{}{\four}{}};
}
\qquad\mbox{and}\qquad
\psi\;=\;
\atomicflow
{
(-3, 0)*{\invisiblemark};
(0, 4)*{\afacu{\six}{}{}{\seven}{\five}{}};
(0,-4)*{\afacd{}{}{}{}{\eight}{}};
}
\]
there are two flow isomorphisms between $\phi$ and $\psi$, but they both share the same underlying graph isomorphism. We usually refer to $(f_V,f_E)$ as $f$ and then write $f(\epsilon)$ and $f(\nu)$ instead of $f_E(\epsilon)$ and $f_V(\nu)$, respectively.
\end{remark}

\begin{notation}\label{notation:LabelsIsomorphicFlows}
Given an atomic flow
\[
\atomicflow
{
(0, 6)*{\afvjdm4{\boldsymbol\epsilon}{}};
(0, 0)*{\affr88};
(4, 2)*{\aflabelleft{\phi}};
(0,-6)*{\afvjum4{\boldsymbol\iota}{}};
}
\quad,
\]
and a flow $\psi$ which is isomorphic to $\phi$, we write
\[
\psi\;=\;
\atomicflow
{
(0, 6)*{\afvjdm4{f(\boldsymbol\epsilon)}{}};
( 0, 0)*{\affr88};
(4, 2)*{\aflabelleft{f(\phi)}};
(0,-6)*{\afvjum4{f(\boldsymbol\iota)}{}};
}
\quad,
\]
if $f$ is a flow isomorphism between $\phi$ and $\psi$.
\end{notation}

\begin{convention}\label{convention:EqualFlows}
We consider atomic flows to be equal modulo flow isomorphisms and modulo the equivalence relation generated by the following graph rewriting system:
\[
\atomicflow
{
(-2,2.5)*{\afacdnw{\one}{}{\two}{}};
(0,-2)*{\afacd{}{}{}{}{\four}{}};
(2,4.35)*{\afvjd{4.6}{\three}{}}
}\quad\rightarrow\quad
\atomicflow
{
(2,2.5)*{\afacdnw{\two}{}{\three}{}};
(0,-2)*{\afacd{}{}{}{}{\four}{}};
(-2,4.35)*{\afvjd{4.6}{\one}{}}
}\quad,\qquad
\atomicflow
{
(-2,-4.5)*{\afacunw{\two}{}{\three}{}};
(0,2)*{\afacu{}{}{}{}{\one}{}};
(2,-4.35)*{\afvju{4.6}{\four}{}}
}\quad\rightarrow\quad
\atomicflow
{
(2,-4.5)*{\afacunw{\three}{}{\four}{}};
(0,2)*{\afacu{}{}{}{}{\one}{}};
(-2,-4.35)*{\afvju{4.6}{\two}{}}
}\quad.
\]
\end{convention}

\begin{notation}
Given an atomic flow $\phi$ and a polarity assignment $\pi$, we write
\[
\atomicflow{
( 0,6)*{\afvjum4{}{}};
( 0,0)*{\affr88};
(-1,2)*{\aflabelleft\ppl};
( 1,2)*{\aflabelright\phi};
( 0,-6)*{\afvjdm4{}{}};
}\quad\mbox{or}\quad
\atomicflow{
( 0,6)*{\afvjum4{}{}};
( 0,0)*{\affr88};
(-1,2)*{\aflabelleft\pmi};
( 1,2)*{\aflabelright\phi};
( 0,-6)*{\afvjdm4{}{}};
}\quad,
\]
respectively, if all the edges in $\phi$ have polarity assignment $\ppl$ (resp., $\pmi$). If we label an atomic flow with a polarity assignment it can not contain any interaction or cut vertices duo to property~\ref{definition:AtomicFlow:item:PolarityAssignment} of Definition~\vref{definition:AtomicFlow}.
\end{notation}

\begin{definition}
Given an atomic flow $\phi$ with polarity assignment $\pi$, the polarity assignment $\bar\pi$ is defined to be, for every $\epsilon$ in $\phi$:
\[
\bar\pi(\epsilon)=
\begin{cases}
\pmi & \mbox{if $\pi(\epsilon)=\ppl$,}
\\
\ppl & \mbox{otherwise.}
\end{cases}
\]
\end{definition}

\TODO{Define connected component.}

\TODO{Define `isolated subflow'.}

\TODO{Define subflow}.

%\begin{example}\label{example:LabelsIsomorphicFlows}
%Consider the following atomic flows:
%\[
%\phi\;=\;
%\atomicflow
%{
%(0,0)="A";
%"A"+(-2, 6)*{\afvju4{\epsilon_1}{}};
%"A"+( 0, 6)*{\cdots};
%"A"+( 2, 6)*{\afvju4{}{\epsilon_n}};
%"A"+( 0, 0)*{\affr88};
%"A"+( 1, 2)*{\aflabelright{\phi}};
%"A"+(-2,-6)*{\afvjd4{\iota_1}{}};
%"A"+( 0,-6)*{\cdots};
%"A"+( 2,-6)*{\afvjd4{}{\iota_m}};
%}
%\quad\mbox{and}\quad
%\psi\;=\;
%\atomicflow
%{
%(-2,12)*{\afacuex{}{}{}{}{}{}52};
%( 0,14)*{\cdots};
%( 2,12)*{\afacuex{}{}{}{}{}{}52};
%%
%(-5,0)="A";
%"A"+(-2, 6)*{\afvju4{\hat\epsilon_1}{}};
%"A"+( 0, 6)*{\cdots};
%"A"+( 2, 6)*{\afvju4{}{\hat\epsilon_n}};
%"A"+( 0, 0)*{\affr88};
%"A"+( 1, 2)*{\aflabelright{\phi}};
%"A"+(-2,-6)*{\afvjd4{\hat\iota_1}{}};
%"A"+( 0,-6)*{\cdots};
%"A"+( 2,-6)*{\afvjd4{}{\hat\iota_m}};
%%
%(5,0)="A";
%"A"+(-2, 6)*{\afvju4{\tilde\epsilon_1}{}};
%"A"+( 0, 6)*{\cdots};
%"A"+( 2, 6)*{\afvju4{}{\tilde\epsilon_n}};
%"A"+( 0, 0)*{\affr88};
%"A"+( 1, 2)*{\aflabelright{\phi}};
%"A"+(-2,-6)*{\afvjd4{\tilde\iota_1}{}};
%"A"+( 0,-6)*{\cdots};
%"A"+( 2,-6)*{\afvjd4{}{\tilde\iota_m}};
%%
%(-2,-12)*{\afacdex{}{}{}{}{}{}52};
%( 0,-14)*{\cdots};
%( 2,-12)*{\afacdex{}{}{}{}{}{}52};
%}\quad.
%\]
%By Defintion~\vref{definition:LabelsIsomorphicFlows} this means that there are bijections $f_1$ and $f_2$ between $\phi$ and each of the subflows labelled $\phi$ in $\psi$, such that, for every $1\le i\le n$ (resp., $1\le i\le m$), we have $f_1(\epsilon_i)=\hat\epsilon_i$ and $f_2(\epsilon_i)=\tilde\epsilon_i$ (resp., $f_1(\iota_i)=\hat\iota_i$ and $f_2(\iota_i)=\tilde\iota_i$).

%This way of creating atomic flows by joining together (by use of (co) contractions) copies of an existing flow will be crucial for the global transformations we present later on. We note that in the construction above, and also in all the constructions we will present, we always respect the bijections between the sublfows when we join together edges with (co)contractions. In other words, we only connect two edges $\hat\epsilon_i$ and $\tilde\epsilon_j$ (resp., $\hat\iota_i$ and $\tilde\iota_j$) by a cocontraction (resp., contraction) if $i=j$.

%Since we know that we will always respect this restriction, the labeling of both $\hat\epsilon_i$ and $\tilde\epsilon_i$ is redundant. One can be deduced from the other.

%To reduce the amount of redundant information in the representation of our flows we wish to use the following notation to represent the above atomic flow:
%\[
%\psi\;=\;
%\atomicflow
%{
%(-2,12)*{\afacuex{}{}{}{}{\epsilon_1}{}52};
%( 0,14)*{\cdots};
%( 2,12)*{\afacuex{}{}{}{}{}{\epsilon_n}52};
%%
%(-5,0)="A";
%"A"+(-2, 6)*{\afvju4{}{}};
%"A"+( 0, 6)*{\cdots};
%"A"+( 2, 6)*{\afvju4{}{}};
%"A"+( 0, 0)*{\affr88};
%"A"+( 1, 2)*{\aflabelright{\phi}};
%"A"+(-2,-6)*{\afvjd4{}{}};
%"A"+( 0,-6)*{\cdots};
%"A"+( 2,-6)*{\afvjd4{}{}};
%%
%(5,0)="A";
%"A"+(-2, 6)*{\afvju4{}{}};
%"A"+( 0, 6)*{\cdots};
%"A"+( 2, 6)*{\afvju4{}{}};
%"A"+( 0, 0)*{\affr88};
%"A"+( 1, 2)*{\aflabelright{\phi}};
%"A"+(-2,-6)*{\afvjd4{}{}};
%"A"+( 0,-6)*{\cdots};
%"A"+( 2,-6)*{\afvjd4{}{}};
%%
%(-2,-12)*{\afacdex{}{}{}{}{\iota_1}{}52};
%( 0,-14)*{\cdots};
%( 2,-12)*{\afacdex{}{}{}{}{}{\iota_n}52};
%}\quad.
%\]
%\end{example}

%
%\TODO{We don't specify that we are talking about a specific bijection. Does it matter?}

%\TODO{There might be more isomorphic subflows than the ones we mentioned, that would be bad. We need a way of saying which ones we care about. This was the use of the term `copy' and it is accomplished by giving them the same name.}

%\begin{definition}\label{definition:CorrespondingEdges}
%Given two atomic flows $\phi$ and $\psi$, such that
%\begin{itemize}
%  \item $\psi$ contains the subflows $\phi_1$, $\dots$, $\phi_n$, each of which is isomorphic to $\phi$,
%  \item $f_1$, $\dots$, $f_n$ are bijections from $\phi$ to $\phi_1$, $\dots$, $\phi_n$, respectively,
%  \item $\epsilon$, $\epsilon_1$, $\dots$, $\epsilon_m$ are the upper (resp., lower) edges of $\phi$, and
%  \item $\epsilon'$ is an upper (resp., lower) edge of $\psi$,
%\end{itemize}
%then we say that \emph{$\epsilon$ corresponds to $\epsilon'$} if
%\begin{itemize}
%  \item for some $1\le i\le n$, there is a path from $\epsilon'$ to $f_i(\epsilon)$, and
%  \item for every $1\le i\le n$ and every $1\le j \le m$, there is no path form $\epsilon'$ to $f_i(\epsilon_j)$.
%\end{itemize}
%Whenever we give the same name, $\epsilon$, to two edges in different atomic flows, $\phi$ and $\psi$ we mean that $\epsilon$ in $\psi$ corresponds to $\epsilon$ in $\phi$.
%\end{definition}

%\TODO{As is now, $\epsilon$ can correspond to more than one edge. Remove comment or change def.}

%\begin{remark}
%If $\epsilon$ in $\phi$ corresponds to $\epsilon'$ in $\psi$ it is not a problem to refer to them by the same name since they belong to different atomic flows and since $\epsilon$ can at most correspond to one edge in $\psi$.
%\end{remark}

%\TODO{Remark with references to (all) the uses of this notation.}

%=======================================
\section{Paths and Cycles}\label{section:PathsAndCycles}

\TODO{Remove unneeded stuff from here.}

We now define the notions of `$\ai$-path' and `$\ai$-cycle' in atomic flows. Paths are sequences of adjacent edges that only `go down' or only `go up'; $\ai$-paths are formed by joining paths at interaction or cointeraction vertices; $\ai$-cycles are circular $\ai$-paths. We also define the notion of `simple edge', \emph{i.e.}, an edge connecting an interaction and a cointeraction, as in the first diagram in this paper.

%---------------------------------------
\begin{definition}\label{definition:FlowPaths}
Given an atomic flow $(V,E,\eta,\up,\lo)$ and $\epsilon_1,\dots,\epsilon_h\in E$ such that, for $1\le i<h$, we have $\lo(\epsilon_i)=\up(\epsilon_{i+1})$, $\up(\epsilon_1)=\nu$ and $\lo(\epsilon_h)=\nu'$, we say that $\epsilon_1,\dots,\epsilon_h$ is a \emph{path from $\nu$ to $\nu'$}\index{path} and that $\epsilon_h,\dots,\epsilon_1$ is a \emph{path from $\nu'$ to $\nu$}; both paths have \emph{length} $h$\index{path!length}. An \emph{$\ai$-path from $\nu$ to $\nu'$}\index{$\ai$-path} of \emph{length}\index{$\ai$-path!length} $h$ is either a path from $\nu$ to $\nu'$ of length $h$ or a sequence of edges $\epsilon_1,\dots,\epsilon_k,\epsilon_{k+1},\dots,\epsilon_h$ such that $\epsilon_k \ne \epsilon_{k+1}$ and, for some $\nu''\in V$ with $\eta(\nu'')\in\{\aid,\aiu\}$, we have that $\epsilon_1,\dots,\epsilon_k$ is an $\ai$-path from $\nu$ to $\nu''$ and $\epsilon_{k+1},\dots,\epsilon_h$ is an $\ai$-path from $\nu''$ to $\nu'$. An $\ai$-path of length $h$ is \emph{maximal}\index{$\ai$-path!maximal} if no $\ai$-path containing its edges has length greater than $h$. An $\ai$-path from (resp., to) $\nu$ of length $h$ is a \emph{maximal\/ $\ai$-path from} (resp., \emph{to}) $\nu$ if no $\ai$-path from (resp., to) $\nu$ containing its edges has length greater than $h$. A path from an interaction to a cointeraction vertex or vice versa is called an \emph{$\ai$-connection}.
\end{definition}

%---------------------------------------
\begin{example}\label{example:Paths}
The atomic flow on the left has the $\ai$-paths on the right, and the paths are marked with an asterisk:
\[
\begin{array}{@{}c@{}c@{}}
\atomicflow{
( 2  ,10)*{\afaidnw{}{}};
( 0  , 6)*{\afvju8\one{}};
( 6  , 6)*{\afacd\two{}\three{}\four{}};
( 8  , 8)*{\afawunw{}{}};
(10  , 6)*{\afvjd8{}\five};
( 8  , 0)*{\afaiunw{}{}};
(-1.5, 0)*{\invisiblemark};
(11.5, 0)*{\invisiblemark}}
\qquad&
\begin{array}{@{}lllll@{}}
\one^*               &                &                  &           &       \\
\one,\two            &\two^*          &\three^*          &           &       \\
\one,\two,\four      &\two,\four^*    &\three,\four^*    &\four^*    &       \\
\one,\two,\four,\five&\two,\four,\five&\three,\four,\five&\four,\five&\five^*\\
\end{array}\quad.
\\
\end{array}
\]
In addition, the flow has the paths and $\ai$-paths obtained from the shown ones by inverting the order of edges, for example $\five,\four,\two,\one$ is an $\ai$-path. The $\ai$-paths from the interaction vertex are $\one$ and $\two$ and $\two,\four$ and $\two,\four,\five$; the $\ai$-paths to the contraction vertex are $\one,\two$ and $\two$ and $\three$ and $\four$ and $\five,\four$; of all the $\ai$-paths to the cointeraction vertex, $\two,\four$ is the only $\ai$-connection; the only other $\ai$-connection in the flow is $\four,\two$. The maximal $\ai$-paths are $\one,\two,\four,\five$ and $\three,\four,\five$ and their inverses. The maximal $\ai$-paths from the cointeraction vertex are $\four,\two,\one$ and $\four,\three$ and $\five$; the maximal $\ai$-paths to the contraction vertex are $\one,\two$ and $\three$ and $\five,\four$.
\end{example}

Simple edges represent immediate causality relations between axioms and cuts. They play a crucial role in the following, in particular when they belong to $\ai$-cycles.

\TODO{Remove the rest of this section:}

%---------------------------------------
\begin{definition}\label{DefSimple}
An $\ai$-connection consisting of a single edge is called a \emph{simple edge}. A \emph{clean path} is an $\ai$-path where every $\ai$-connection is a simple edge. An \emph{$\ai$-cycle} is an $\ai$-path from a vertex to itself, where no edge appears twice; we do not distinguish $\ai$-cycles that only differ for cyclic permutations of their edges or for inversion, so, if $\epsilon_1,\dots,\epsilon_h$ is an $\ai$-cycle, then $\epsilon_2,\dots,\epsilon_h,\epsilon_1$ and $\epsilon_h,\dots,\epsilon_1$ are the same $\ai$-cycle. A \emph{fragile cycle} is an $\ai$-cycle containing a simple edge. Atomic flows and $\ai$-paths are both called \emph{cycle-free} if they do not contain $\ai$-cycles.
\end{definition}

%---------------------------------------
\begin{example}\label{ExExtrem}
In the following cycle-free flow all the $\ai$-paths are clean paths; $\one$, $\two$ and $\three$ are $\ai$-connections and simple edges:
\[
\atomicflow{
( 2,0)*{\afaiu{}{}\one{}{}{}};
( 0,4)*{\afacdnw{}{}{}{}};
( 6,4)*{\afaidnw{}{}};
(10,0)*{\afaiu\two{}\three{}{}{}};
(14,4)*{\afaidnw{}{}{}{}};
(18,0)*{\afacd{}{}{}{}{}{}}}
\quad.
\]
\end{example}

%---------------------------------------
\begin{example}
Consider the following atomic flow:
\nopagebreak[4]\medskip\afnegspace
\[
\atomicflow{
( 8,12)*{\afaidex\one{}{}\two{}{}41};
( 0, 6)*{\afacunw\three{}{}\four};
(16, 6)*{\afacunw\seven{}{}\eight};
( 8, 8)*{\afaid{}\five\six{}{}{}};
( 4, 2)*{\afaiunw{}{}};
(12, 2)*{\afaiunw{}{}};
( 8, 0)*{\afaiuex{}{}{}{}{}{}51}}
\quad.
\]
\afnegspace
The flow contains two $\ai$-cycles: $\one,\four,\five,\six,\seven,\two$ and $\one,\three,\eight,\two$. The first $\ai$-cycle contains the two simple edges $\five$ and $\six$, so it is a fragile cycle; the second $\ai$-cycle does not contain any simple edge. Note that the two $\ai$-cycles are `overlapping', in the sense that edges $\one$ and $\two$ belong to both.
\end{example}

\TODO{Isomorphism}