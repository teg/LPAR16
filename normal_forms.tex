\chapter{Normal Forms}\label{chapter:NormalForms}

Intro:
\begin{itemize}
\item Sequent Calculus: normal form means `cut free'. Not topological. Syntactic.
\item To get syntax independence of proofs we need syntax independence of normalisation.
\item in deep inference we have locality and top-down symmetry.
\begin{itemize}
\item locality gives topology; and
\item symmetry gives generalisation of cut-elimination.
\end{itemize}
The minimal ammount of information needed to describe these things: Atomic Flows.
\end{itemize}

Not a big surprise that we can describe this with atomic flows (by design). Later we get the big surprise that we can obtain this using (only) atomic flows.

\TODO{Informal explanation of the different normal forms, starting from `streamlinig'.}

\TODO{Alessio said: `\emph{I think it's a mistake to consider a derivation weakly streamlined with respect to a polarity. It would be better to say that it is weakly streamlined with the respect to the positive subflow, given a polarity, or something like this.}'}

%---------------------------------------
\begin{definition}\label{definition:FlowNormalForms}
An atomic flow is
\begin{enumerate}
%---
\item\label{definition:FlowNormalForms:item:SimpleForm}
\emph{in simple form with respect to the polarity assignment $\pi$}\index{simple form!flow} if it can be represented as
\[
\atomicflow{
(-20, 14)*{\afvjm4};
(-20,  8)*{\affr68};
(-20, 10)*{\aflabelleft{\ppl}};
%-
(-22,  0)*{\afvjm8};
%-
(-20, -8)*{\affr68};
(-20, -6)*{\aflabelleft{\ppl}};
(-20,-14)*{\afvjm4};
%-
( -3, 16)*{\afaidmex{}{}{}{}{}{}92};
(-12,  8)*{\affr68};
(-12, 10)*{\aflabelleft{\ppl}};
(-15,  0)*{\afcjrm68};
%-
(-15,  0)*{\afcjlm68};
(-12, -8)*{\affr68};
(-12, -6)*{\aflabelleft{\ppl}};
( -3,-16)*{\afaiumex{}{}{}{}{}{}92};
%--
( -1,  8)*{\afaidmex{}{}{}{}{}{}32};
( -4,  0)*{\affr68};
( -4,  2)*{\aflabelleft{\ppl}};
(  6,  8)*{\afvjm8};
( 10, 10)*{\afvjm{12}};
(  6,  0)*{\affr{10}8};
(  4,  2)*{\aflabelleft{\pmi}};
(  6, -8)*{\afvjm8};
( 10,-10)*{\afvjm{12}};
( -1, -8)*{\afaiumex{}{}{}{}{}{}32};
}\qquad
\atomicflow{
( -8, 12.75)*{\afvjm{6.5}};
(  0, 13.5)*{\afawdm{}{}{}{}{}{}};
%---
( -6, 5.5)*{\copy\contrup};
( -4, 5.5)*{\affr{10}8};
( -2, 5.5)*{\copy\contrdown};
%---
( -5,-2.5)*{\afaium{}{}{}{}{}{}};
(  0,   0)*{\afvjm3};
(  5, 2.5)*{\afaidm{}{}{}{}{}{}};
%---
(  2,-5.5)*{\copy\contrup};
(  4,-5.5)*{\affr{10}8};
(  6,-5.5)*{\copy\contrdown};
%---
(  0,-13.5)*{\afawum{}{}{}{}{}{}};
(  8,-12.75)*{\afvjm{6.5}};
}\quad;
\]
%---
\item\label{definition:FlowNormalForms:item:WeaklyStreamlinedPolarity}
\emph{weakly streamlined with respect to the polarity assignment $\pi$}\index{streamlined!weakly!with respect to polarity assignment} if it can be represented as
\[
\atomicflow{
(-20, 14)*{\afvjm4};
(-20,  8)*{\affr68};
(-20, 10)*{\aflabelleft{\ppl}};
%-
(-22,  0)*{\afvjm8};
%-
(-20, -8)*{\affr68};
(-20, -6)*{\aflabelleft{\ppl}};
(-20,-14)*{\afvjm4};
%-
( -9, 16)*{\afaidmex{}{}{}{}{}{}32};
(-12,  8)*{\affr68};
(-12, 10)*{\aflabelleft{\ppl}};
(-15,  0)*{\afcjrm68};
%-
(-15,  0)*{\afcjlm68};
(-12, -8)*{\affr68};
(-12, -6)*{\aflabelleft{\ppl}};
( -9,-16)*{\afaiumex{}{}{}{}{}{}32};
%--
( -6,  8)*{\afvjm8};
(  0, 10)*{\afvjm{12}};
( -3,  0)*{\affr88};
( -4,  2)*{\aflabelleft{\pmi}};
( -6, -8)*{\afvjm8};
(  0,-10)*{\afvjm{12}};
}\qquad
\atomicflow{
( -8, 12.75)*{\afvjm{6.5}};
(  0, 13.5)*{\afawdm{}{}{}{}{}{}};
%---
( -6, 5.5)*{\copy\contrup};
( -4, 5.5)*{\affr{10}8};
( -2, 5.5)*{\copy\contrdown};
%---
( -5,-2.5)*{\afaium{}{}{}{}{}{}};
(  0,   0)*{\afvjm3};
(  5, 2.5)*{\afaidm{}{}{}{}{}{}};
%---
(  2,-5.5)*{\copy\contrup};
(  4,-5.5)*{\affr{10}8};
(  6,-5.5)*{\copy\contrdown};
%---
(  0,-13.5)*{\afawum{}{}{}{}{}{}};
(  8,-12.75)*{\afvjm{6.5}};
}\quad;
\]
%---
\item\label{definition:FlowNormalForms:item:WeaklyStreamlined}
\emph{weakly streamlined}\index{streamlined!weakly} if it can be represented as
\[
\atomicflow{
( -8, 11.5)*{\afvjm4};
(  0, 13.5)*{\afawdm{}{}{}{}{}{}};
%---
( -6, 5.5)*{\copy\contrup};
( -4, 5.5)*{\affr{10}8};
( -2, 5.5)*{\copy\contrdown};
%---
( -5,-2.5)*{\afaium{}{}{}{}{}{}};
(  0,   0)*{\afvjm3};
(  5, 2.5)*{\afaidm{}{}{}{}{}{}};
%---
(  2,-5.5)*{\copy\contrup};
(  4,-5.5)*{\affr{10}8};
(  6,-5.5)*{\copy\contrdown};
%---
(  0,-13.5)*{\afawum{}{}{}{}{}{}};
(  8,-11.5)*{\afvjm4};
}\quad;
\]
%---
\item\label{definition:FlowNormalForms:item:Streamlined}
\emph{streamlined}\index{streamlined} if it can be represented as
\[
\atomicflow{
( -5, 11.5)*{\afvjm4};
%---
(-7.5, 5.5)*{\copy\contrup};
(  -5, 5.5)*{\affr{12}8};
(-2.5, 5.5)*{\copy\contrdown};
%---
(-10,-2.5)*{\afawum{}{}{}{}{}{}};
( -5,-2.5)*{\afaium{}{}{}{}{}{}};
(  0,   0)*{\afvjm3};
(  5, 2.5)*{\afaidm{}{}{}{}{}{}};
( 10, 2.5)*{\afawdm{}{}{}{}{}{}};
%---
(2.5,-5.5)*{\copy\contrup};
(  5,-5.5)*{\affr{12}8};
(7.5,-5.5)*{\copy\contrdown};
%---
(  5,-11.5)*{\afvjm4};
}\quad;
\]
%---
\item\label{definition:FlowNormalForms:item:SuperStreamlined}
\emph{super streamlined}\index{streamlined!super} if it can be represented as
\[
\atomicflow{
(-12,  9.5)*{\afawum{}{}{}{}{}{}};
%---
( -4, 11.5)*{\afvjm4};
%---
( -6, 5.5)*{\copy\contrup};
( -4, 5.5)*{\affr{10}8};
( -2, 5.5)*{\copy\contrdown};
%---
( -5,-2.5)*{\afaium{}{}{}{}{}{}};
(  0,   0)*{\afvjm3};
(  5, 2.5)*{\afaidm{}{}{}{}{}{}};
%---
(  2,-5.5)*{\copy\contrup};
(  4,-5.5)*{\affr{10}8};
(  6,-5.5)*{\copy\contrdown};
%---
(  4,-11.5)*{\afvjm4};
%---
( 12, -9.5)*{\afawdm{}{}{}{}{}{}};
}\quad;\quad\mbox{and}
\]
%---
\item\label{definition:FlowNormalForms:item:HyperStreamlined}
\emph{hyper streamlined}\index{streamlined!hyper} if it can be represented as
\[
\atomicflow{
(-12,  9.5)*{\afawum{}{}{}{}{}{}};
%---
( -4, 11.5)*{\afvjm4};
%---
( -4, 5.5)*{\copy\contrup};
( -4, 5.5)*{\affr{10}8};
%---
( -5,-2.5)*{\afaium{}{}{}{}{}{}};
(  0,   0)*{\afvjm3};
(  5, 2.5)*{\afaidm{}{}{}{}{}{}};
%---
(  4,-5.5)*{\affr{10}8};
(  4,-5.5)*{\copy\contrdown};
%---
(  4,-11.5)*{\afvjm4};
%---
( 12, -9.5)*{\afawdm{}{}{}{}{}{}};
}\quad.
\]
\end{enumerate}
\end{definition}

\TODO{Ensure that all the normal forms of atomic flows have a corresponding definition for derivations.}

\begin{definition}\label{definition:DerSimpleForm}
A derivation with associated atomic flow $\phi$ is \emph{in simple form with respect to} (\emph{the atom}) $a$\index{simple form!derivation!with respect to atom}, if $\pi$ is a polarity assignment for $\phi$, such that the edges in $\phi$ mapped to from occurrences of $a$ have a positive polarity, and the restriction of $\phi$ to $a$ is in simple form with respect to $\pi$.
\end{definition}

\begin{definition}\label{definition:DerStreamlined}
A derivation with associated atomic flow $\phi$ is \emph{weakly streamlined} (resp., \emph{streamlined}\index{streamlined!derivation}, \emph{super streamlined} and \emph{hyper streamlined}) if $\phi$ is \emph{weakly streamlined} (resp., \emph{streamlined}, \emph{super streamlined} and \emph{hyper streamlined}). The derivation is \emph{weakly streamlined with respect to} (\emph{the atom}) $a$\index{streamlined!weakly!with respect to atom}, if $\pi$ is a polarity assignment for $\phi$, such that the edges in $\phi$ mapped to from occurrences of $a$ have a positive polarity, and the restriction of $\phi$ to $a$ is weakly streamlined with respect to $\pi$.
\end{definition}

%---------------------------------------
\begin{example}\label{example:Streamlined}
The first flow is weakly streamlined, the other two are hyper streamlined:
\[
\aflower{\atomicflow{
(0,6)*{\afacd{}{}{}{}{}{}};
(4,6)*{\afawd{}{}{}{}};
(2,0)*{\afaiunw{}{}}}}
\quad,\qquad
\atomicflow{
( 2,0)*{\afacd{}{}{}{}{}{}};
( 0,4)*{\afawdnw{}{}};
( 6,8)*{\afacu{}{}{}{}{}{}};
(10,2)*{\afaiunw{}{}{}{}};
(12,8)*{\afvj8}}
\qquad\hbox{and}\qquad
\atomicflow{
(10,8)*{\afacu{}{}{}{}{}{}};
(16,8)*{\afvj8};
( 2,4)*{\afaidnw{}{}};
( 0,0)*{\afvj8};
(14,2)*{\afaiunw{}{}};
( 6,0)*{\afacd{}{}{}{}{}{}}}
\quad.
\]
\end{example}

\begin{proposition}\label{proposition:FlowWeaklyStreamlinedPolarity}
Given a polarity assignment $\pi$, an atomic flow that is weakly streamlined with respect to both $\pi$ and $\bar\pi$ is weakly streamlined. 
\end{proposition}

\begin{proposition}\label{proposition:FlowCutFree}
A streamlined atomic flow with no pair of upper (resp., lower) edges such that there is an $\ai$-path between them, contains no cut (resp., axiom) vertices.
\end{proposition}

%---------------------------------------
\begin{proposition}\label{proposition:FlowNormalFormsNoUpper}
Given an atomic flow with no upper (resp., lower) edges, it can be represented as
\begin{enumerate}
\item\label{proposition:FlowNormalFormsNoUpper:item:Streamlined}
\[
\atomicflow{
(  5, 2.5)*{\afaidm{}{}{}{}{}{}};
( 10, 2.5)*{\afawdm{}{}{}{}{}{}};
%---
(4,-5.5)*{\copy\contrup};
(6,-5.5)*{\affr{10}8};
(8,-5.5)*{\copy\contrdown};
%---
(6,-11.5)*{\afvjm4};
(0,-18)*{\invisiblemark};
}
\qquad
\left(\mbox{resp.,}\quad
\atomicflow{
( 0,18)*{\invisiblemark};
(-6,11.5)*{\afvjm4};
%---
(-8, 5.5)*{\copy\contrup};
(-6, 5.5)*{\affr{10}8};
(-4, 5.5)*{\copy\contrdown};
%---
(-10,-2.5)*{\afawum{}{}{}{}{}{}};
( -5,-2.5)*{\afaium{}{}{}{}{}{}};
}
\quad\right)
\quad,
\]
if it is streamlined;
%---
\item\label{proposition:FlowNormalFormsNoUpper:item:SuperStreamlined}
\[
\atomicflow{
(  4, 2.5)*{\afaidm{}{}{}{}{}{}};
%---
(  2,-5.5)*{\copy\contrup};
(  4,-5.5)*{\affr88};
(  6,-5.5)*{\copy\contrdown};
%---
(  4,-11.5)*{\afvjm4};
%---
( 11, -9.5)*{\afawdm{}{}{}{}{}{}};
(0,-18)*{\invisiblemark};
}
\qquad
\left(\mbox{resp.,}\quad
\atomicflow{
( 0,18)*{\invisiblemark};
(-11,  9.5)*{\afawum{}{}{}{}{}{}};
%---
( -4, 11.5)*{\afvjm4};
%---
( -6, 5.5)*{\copy\contrup};
( -4, 5.5)*{\affr88};
( -2, 5.5)*{\copy\contrdown};
%---
( -4,-2.5)*{\afaium{}{}{}{}{}{}};
}
\quad\right)
\quad,
\]
if it is super streamlined; and
%---
\item\label{proposition:FlowNormalFormsNoUpper:item:HyperStreamlined}
\[
\atomicflow{
(  4, 2.5)*{\afaidm{}{}{}{}{}{}};
%---
(  4,-5.5)*{\affr88};
(  4,-5.5)*{\copy\contrdown};
%---
(  4,-11.5)*{\afvjm4};
%---
( 11, -9.5)*{\afawdm{}{}{}{}{}{}};
(0,-18)*{\invisiblemark};
}
\qquad
\left(\mbox{resp.,}\quad
\atomicflow{
( 0,18)*{\invisiblemark};
(-11,  9.5)*{\afawum{}{}{}{}{}{}};
%---
( -4, 11.5)*{\afvjm4};
%---
( -4, 5.5)*{\copy\contrup};
( -4, 5.5)*{\affr88};
%---
( -4,-2.5)*{\afaium{}{}{}{}{}{}};
}
\quad\right)
\quad,
\]
if it is hyper streamlined.
\end{enumerate}
\end{proposition}

\begin{remark}\label{remark:DerCutFree}
A streamlined proof is cut-free, a super streamlined proof is analytic and a hyper streamlined proof is in system $\KS$.
\end{remark}
